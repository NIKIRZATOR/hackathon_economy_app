// lib/features/almanac/data/almanac_links.dart
//
// ССЫЛКИ ИЗ EXCEL: лист «ФЛ», столбцы «Продукт » → «Ссылка».

const Map<String, String> kAlmanacProductLinks = {
  'Умная дебетовая карта "Мир"': 'https://www.gazprombank.ru/personal/cards/7579039/',
  'Премиальная карта Mir Supreme': 'https://www.gazprombank.ru/premium/mirsupreme2/',
  'Простая кредитная карта': 'https://www.gazprombank.ru/personal/credit-cards/7827199/',
  'Дебетовая карта с кэшбэком для самозанятых': 'https://www.gazprombank.ru/personal/cards/7611615/',
  'Умная дебетовая карта + мобильная связь со скидкой до 50%': 'https://www.gazprombank.ru/personal/cards/6942197/',
  'Кредитная карта с льготным периодом до 120 дней': 'https://www.gazprombank.ru/personal/credit-cards/7950641/',
  'Кредитная карта 90 дней': 'https://www.gazprombank.ru/personal/credit-cards/6125247/',
  'Кредитная карта 180 дней Премиум': 'https://www.gazprombank.ru/premium/credit-card-180/',
  'Дебетовая Пенсионная карта': 'https://www.gazprombank.ru/personal/cards/42388/',
  'Пакет услуг «ГАЗФОНД пенсионные накопления»': 'https://www.gazprombank.ru/personal/cards/5669807/',
  'Пенсионная карта Газпромбанка и АО «НПФ ГАЗФОНД»': 'https://www.gazprombank.ru/personal/cards/42397/',
  'Виртуальная дебетовая карта ГПБ&ФК «Зенит»': 'https://www.gazprombank.ru/personal/cards/7215353/',
  'Дебетовая карта «Газпромбанк – ФК «Зенит»': 'https://www.gazprombank.ru/personal/cards/42389/',
  'Дебетовая карта хоккейного клуба СКА': 'https://www.gazprombank.ru/personal/cards/7573859/',
  'Кредитная карта для самозанятых': 'https://www.gazprombank.ru/personal/credit-cards/7601141/',
  'Дебетовая карта для школьников': 'https://www.gazprombank.ru/personal/cards/5680741/',
  'Кредитная карта 180 дней': 'https://www.gazprombank.ru/personal/credit-cards/6125248/',
  'Приведи друга': 'https://www.gazprombank.ru/personal/page/referal/',
  'Семейная ППК': 'https://www.gazprombank.ru/personal/page/ppk-family/',
  'ИИС «Инвесткопилка»': 'https://www.gazprombank.ru/personal/distance/investapp/',
  'Инвестиции': 'https://www.gazprombank.ru/personal/page/increase/investment/',
  '«Ежедневная выгода»': 'https://www.gazprombank.ru/accounts/daily-benefit/',
  '«Ежедневный процент»': 'https://www.gazprombank.ru/accounts/daily-percentage/',
  '«Премиум»': 'https://www.gazprombank.ru/premium/ns/',
  'Социальный счет': 'https://www.gazprombank.ru/accounts/social/',
  'Вклад «Новые деньги»': 'https://www.gazprombank.ru/personal/increase/deposits/detail/7582023/',
  'Вклад «Ключевой момент»': 'https://www.gazprombank.ru/personal/increase/deposits/detail/7937943/',
  'Вклад «Копить»': 'https://www.gazprombank.ru/personal/increase/deposits/detail/2491/',
  'Вклад «В Плюсе»': 'https://www.gazprombank.ru/personal/increase/deposits/detail/7476877/',
  'Вклад «Расширяй возможности»': 'https://www.gazprombank.ru/personal/increase/deposits/detail/6992387/',
  'Социальный вклад': 'https://www.gazprombank.ru/personal/increase/deposits/detail/7889383/',
  'Кредит наличными': 'https://www.gazprombank.ru/personal/take_credit/consumer_credit/5004451/',
  'Кредит наличными под залог недвижимости': 'https://www.gazprombank.ru/personal/bail/pod-zalog/',
  'Кредит на авто и другие цели': 'https://www.gazprombank.ru/personal/avtokredit/5601789/',
  'Рефинансирование потребительских кредитов': 'https://www.gazprombank.ru/personal/take_credit/consumer_credit/42164/',
  'Дачный кредит': 'https://www.gazprombank.ru/personal/take_credit/consumer_credit/7638024/',
  'Ипотека': 'https://www.gazprombank.ru/personal/mortgage/',
  'Господдержка ИТ': 'https://www.gazprombank.ru/personal/mortgage/it/',
  'Кредит на строительство дома': 'https://www.gazprombank.ru/personal/mortgage/housebuild/',
  'Семейная ипотека': 'https://www.gazprombank.ru/personal/mortgage/family/',
  'Ипотека с господдержкой': 'https://www.gazprombank.ru/personal/mortgage/gp/',
  'Военная ипотека': 'https://www.gazprombank.ru/personal/mortgage/army/',
  'Льготная ипотека для Дальнего Востока': 'https://www.gazprombank.ru/personal/mortgage/fareast_lp/',
  'Льготная ипотека для ИТ-специалистов': 'https://www.gazprombank.ru/personal/mortgage/it/',
  'Рефинансирование ипотечного кредита': 'https://www.gazprombank.ru/personal/mortgage/refinance/',
  'Газпромбанк Страхование': 'https://www.gazprombank.ru/personal/insurance/',
  'Переводы': 'https://www.gazprombank.ru/personal/transfers/',
  'Сейфы': 'https://www.gazprombank.ru/personal/page/safe-deposit/',
  'Счета и переводы': 'https://www.gazprombank.ru/personal/page/accounts-transfers/',
  'Подписка GPB+': 'https://www.gazprombank.ru/personal/page/gpbplus/',
  'Банковские сейфы': 'https://www.gazprombank.ru/personal/page/safe-deposit/',
  'Кредитный рейтинг': 'https://www.gazprombank.ru/personal/credit-profile/',
  'Отчет о кредитной истории': 'https://www.gazprombank.ru/personal/page/credit-report/',
  'Переводы за рубеж': 'https://www.gazprombank.ru/personal/page/prevodyzarubezh/',
  'Gazprom Pay': 'https://www.gazprombank.ru/personal/page/payment-service/gazprom-pay/',
  'Интернет-банк': 'https://www.gazprombank.ru/personal/page/online-bank/',
  'Мобильное приложение': 'https://www.gazprombank.ru/personal/page/app/',
  'GPB-i-Trade': 'https://www.gazprombank.ru/personal/brokerage_service/#tab-2',
  'GorodPay': 'https://www.gazprombank.ru/personal/page/gorodpay/',
  'Открыть брокерский счет': 'https://www.gazprombank.ru/personal/distance/investapp/',
  'Брокер-клиент': 'https://www.gazprombank.ru/personal/brokerage_service/#tab-3',
  'Дистанционные сервисы': 'https://www.gazprombank.ru/personal/distance/',
  'Стать клиентом Газпромбанка онлайн': 'https://www.gazprombank.ru/personal/page/biosystem/',
  'Открытый API курсов валют и металлов': 'https://www.gazprombank.ru/personal/page/openapi/',
};

// Нормализация для «почти таких же» названий в альманахе.
// Удаляем кавычки-ёлочки/дефисы/двойные пробелы и приводим к lower.
String _norm(String s) {
  final lower = s.toLowerCase();
  final cleared = lower
      .replaceAll('«', '')
      .replaceAll('»', '')
      .replaceAll('"', '')
      .replaceAll('–', '-')
      .replaceAll('—', '-')
      .replaceAll(RegExp(r'[\s]+'), ' ')
      .trim();
  return cleared;
}

/// Публичная функция: вернуть ссылку по названию из альманаха.
String? almanacLinkByTitle(String productTitle) {
  // 1) точное совпадение
  final exact = kAlmanacProductLinks[productTitle];
  if (exact != null && exact.isNotEmpty) return exact;

  // 2) по нормализованной строке (если в альманахе слегка другое написание)
  final normTitle = _norm(productTitle);
  for (final entry in kAlmanacProductLinks.entries) {
    if (_norm(entry.key) == normTitle) return entry.value;
  }
  return null;
}
